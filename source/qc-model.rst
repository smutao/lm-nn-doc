.. _qc-model:
..    include:: <isonum.txt>
.. toctree::
   :hidden:


===================================
Quantum Chemistry Modeling Packages
===================================

LModeA-nano can directly read the formatted checkpoint file generated by Gaussian and Q-Chem. Other quantum chemistry modeling packages (e.g. ORCA, xtb) requires the formatted data file generated by UniMoVib.


.. note::

   LModeA-nano can do basic local mode analysis for bond length and bond angles.  More advanced analysis including decomposition of normal modes, adiabatic connection scheme and other internal coordinates are supported only by LModeA code. 



Gaussian 
----------

Tested with Gaussian 16.

Perform an OPT+Freq calculation to do geometry optimization and then vibrational analysis.

.. literalinclude:: _static/code/g16-inp.txt


Please check the vibrational frequencies to make sure that the molecular structure is at a local minimum point.

The ``%chk`` is a must to first produce checkpoint file. Convert it to formatted one with ::

  $ formchk ben.chk 
  
The corresponding ``.fchk`` file is then generated.   Then follow the instructions in :ref:`quickstart example <quick-qc>`  to do local mode analysis with LModeA-nano.


Q-Chem
----------

Tested with Q-Chem 5.1.0

Given an optimized molecular structure, perform vibrational analysis 

.. literalinclude:: _static/code/qchem-inp.txt

``GUI 2`` asks Q-Chem to produce the formatted checkpoint file ``.fchk``.  Always check the vibrational frequencies before doing local mode analysis. 
Then follow the instructions in :ref:`quickstart example <quick-qc>`  to do local mode analysis with LModeA-nano.




Other Packages
----------------

To perform local mode analysis based on the calculation results by other quantum chemistry packages, 
the  UniMoVib package should be installed first. 

The workflow is 

* Perform vibrational analysis on an optimized molecular structure with a quantum chemistry package (e.g. ORCA, xtb) 

* Run UniMoVib to generate a formatted data file ``.umv`` by parsing the output file in the last step

* Load the ``.umv`` file to LModeA-nano for local mode analysis



A complete list of supported quantum chemistry packages by UniMoVib can be found at https://github.com/zorkzou/UniMoVib.

In this tutorial, ORCA 4 is used as an example. 

The vibrational analysis of an optimized molecular structure with ORCA 4 produces an ``.hess`` file. Compose an input file ``job.inp`` for UniMoVib

.. literalinclude:: _static/code/unimovib-inp.txt

``ifsave=.true.`` saves a formatted data file ``.umv``. Running UniMoVib with above input, it produces ``job.umv``.

Compose an input file ``unimovib.inp`` for LModeA-nano ::

  @unimovib

  UMV = job.umv
  
  

Follow these steps to perform local mode analysis with LModeA-nano



* open a new PyMOL window and launch LModeA-nano by clicking **Plugin** |rarr| **LModeA-nano**
 
* click the **... (Browse)** button and select the ``unimovib.inp`` file

* change the program drop-down list from **VASP** to **UniMoVib**

* click **Load**

* change **Dimensions** to ``0`` and click **Confirm** button

 


Then local mode analysis can be performed as described in  :ref:`quickstart examples <quick-example>`.  





 



